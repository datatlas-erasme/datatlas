# Datatlas

## Development

Run `prettier` on whole repository:

```
nx format:write
```

Run `lint` on whole repository

```
nx run-many --target=lint
```

### Frontend

**Kepler.gl** uses **Mapbox GL JS** to render map styles.
You must configure the `REACT_APP_MAPBOX_ACCESS_TOKEN` environment variable in a `.env` file (see `./apps/frontend/.env.example` for an example).

> https://docs.mapbox.com/help/getting-started/access-tokens/

```
nx serve frontend
```

#### Stack

- [redux-toolkit](https://redux-toolkit.js.org/) to handle `redux` related stuff.
- [RTK Query](https://redux.js.org/tutorials/essentials/part-7-rtk-query-basics) is used to make API calls.

> We're querying the `api` state slice to display data in components.
> So the previous `projects` state slice isn't used right now but be used in the future if state normalization is required.
>
> - https://redux-toolkit.js.org/api/createEntityAdapter
> - https://redux.js.org/tutorials/essentials/part-8-rtk-query-advanced#transforming-responses
> - https://dev.to/srmagura/the-great-redux-toolkit-debate-5045

### Test

```shell
npx nx run frontend:test
```

> Some useful resources to understand the **frontend** testing strategy :
>
> - https://redux.js.org/usage/writing-tests
> - https://mswjs.io/
> - https://github.com/mswjs/examples/tree/master/examples/rest-react/src

### Backend

Run with

```
nx serve backend
```

#### API Reference

##### Projects

**Get all projects**

```
GET /api/projects
```

returns :

```json
[
  {
    "id": "1",
    "name": "project 1",
    "draft": true,
    "dataset": "a string",
    "owner": "1"
]
```

**Get a project**

```
GET /api/projects/:id
```

returns :

```json
{
  "id": "1",
  "name": "project 1",
  "draft": true,
  "dataset": "a string",
  "owner": "1"
}
```

**Create a project**

```
POST /api/project
```

body : x-www-form-urlencoded
Parameters:
name draft dataset owner

| Name      | Type      | Description                      |
| :-------- | :-------- | :------------------------------- |
| `name`    | `string`  | your project name                |
| `draft`   | `boolean` | if the project is public or not  |
| `dataset` | `string`  | wip will be an object            |
| `owner`   | `string`  | wich user id is owner of project |

**Update a project**

```
PUT /api/project/:id
```

body : x-www-form-urlencoded
Parameters:
name draft dataset owner

| Name      | Type      | Description                      |
| :-------- | :-------- | :------------------------------- |
| `name`    | `string`  | your project name                |
| `draft`   | `boolean` | if the project is public or not  |
| `dataset` | `string`  | wip will be an object            |
| `owner`   | `string`  | wich user id is owner of project |

returns :

```json
{
  "id": "1",
  "name": "project 1",
  "draft": true,
  "dataset": "a string",
  "owner": "1"
}
```

**Delete a project**

```
DELETE /api/project/:id
```

returns :

```json
true
```

> Navigate to http://localhost:4200/. The app will automatically reload if you change any of the source files.

## Design

**Figma** sketch :
`https://www.figma.com/proto/lVX7Lycox3AGixBhhbhQsQ/DatAtlas`

> _Made by [SiaPartners](https://www.sia-partners.com/)._

## nx

<a href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, a Smart, fast and extensible build system.](https://nx.dev)** ✨

### Understand this workspace

Run `nx graph` to see a diagram of the dependencies of the projects.

### Further help

Visit the [Nx Documentation](https://nx.dev) to learn more.
